"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.opportunityRouter = void 0;
const express_1 = require("express");
const Opportunity_controller_1 = require("../controllers/Opportunity.controller");
const application_routes_1 = require("./application.routes");
const Opportunity_services_1 = require("../services/Opportunity.services");
const ValidatyBody_middleware_1 = require("../middlewares/ValidatyBody.middleware");
const opportunity_schema_1 = require("../schemas/opportunity.schema");
const IsOpportunityIdValide_middleware_1 = require("../middlewares/IsOpportunityIdValide.middleware");
const tsyringe_1 = require("tsyringe");
const verifyToken_middleware_1 = require("../middlewares/verifyToken.middleware");
const IsOpportunityOwner_middleware_1 = require("../middlewares/IsOpportunityOwner.middleware");
exports.opportunityRouter = (0, express_1.Router)();
tsyringe_1.container.registerSingleton('OpportunityServices', Opportunity_services_1.OpportunityServices);
const opportunityController = tsyringe_1.container.resolve(Opportunity_controller_1.OpportunityController);
exports.opportunityRouter.post('/', ValidatyBody_middleware_1.ValidateBody.execute(opportunity_schema_1.opportunityCreateSchema), verifyToken_middleware_1.VerifyToken.execute, (req, res) => opportunityController.create(req, res));
exports.opportunityRouter.get('/', (req, res) => opportunityController.findMany(req, res));
exports.opportunityRouter.use('/:id', IsOpportunityIdValide_middleware_1.IsOpportunityIdValide.execute);
exports.opportunityRouter.get('/:id', (req, res) => opportunityController.findOne(req, res));
exports.opportunityRouter.patch('/:id', ValidatyBody_middleware_1.ValidateBody.execute(opportunity_schema_1.opportunityUpdateSchema), verifyToken_middleware_1.VerifyToken.execute, IsOpportunityOwner_middleware_1.IsOpportunityOwner.execute, (req, res) => opportunityController.update(req, res));
exports.opportunityRouter.delete('/:id', verifyToken_middleware_1.VerifyToken.execute, IsOpportunityOwner_middleware_1.IsOpportunityOwner.execute, (req, res) => opportunityController.delete(req, res));
exports.opportunityRouter.use('/', application_routes_1.applicationRouter);
